<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema">
		<dataSource>
			<name>ИсточникДанных1</name>
			<dataSourceType>Local</dataSourceType>
		</dataSource>
		<dataSet xsi:type="DataSetQuery">
			<name>НаборДанных1</name>
			<field xsi:type="DataSetFieldField">
				<dataPath>Номенклатура</dataPath>
				<field>Номенклатура</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>SKU</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧЦ='7'; ЧДЦ='2'</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Контрагент</dataPath>
				<field>Контрагент</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>АКБ</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧЦ='7'; ЧДЦ='2'</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Дистрибьютор</dataPath>
				<field>Дистрибьютор</field>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Период</dataPath>
				<field>Период</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Период</d5p1:content>
					</d5p1:item>
				</title>
				<role>
					<periodNumber xmlns="http://v8.1c.ru/8.1/data-composition-system/common">1</periodNumber>
					<periodType xmlns="http://v8.1c.ru/8.1/data-composition-system/common">Main</periodType>
				</role>
				<presentationExpression>Выбор 
Когда Период=1 Тогда "Январь" 
Когда Период=2 Тогда "Февраль" Когда Период=3 Тогда "Март" Когда Период=4 Тогда "Апрель" Когда Период=5 Тогда "Май" Когда Период=6 Тогда "Июнь" Когда Период=7 Тогда "Июль" Когда Период=8 Тогда "Август" Когда Период=9 Тогда "Сентябрь" Когда Период=10 Тогда "Октябрь" Когда Период=11 Тогда "Ноябрь" Когда Период=12 Тогда "Декабрь" Иначе Период
Конец </presentationExpression>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<use>false</use>
						<parameter>СтильГраницы</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d7p1:Line" width="0" gap="false">
							<d7p1:style xsi:type="d7p1:SpreadsheetDocumentCellLineType">None</d7p1:style>
						</value>
						<item xsi:type="dcsset:SettingsParameterValue">
							<parameter>СтильГраницы.Слева</parameter>
							<value xmlns:d8p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d8p1:Line" width="2" gap="false">
								<d8p1:style xsi:type="d8p1:SpreadsheetDocumentCellLineType">Solid</d8p1:style>
							</value>
						</item>
						<item xsi:type="dcsset:SettingsParameterValue">
							<parameter>СтильГраницы.Сверху</parameter>
							<value xmlns:d8p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d8p1:Line" width="2" gap="false">
								<d8p1:style xsi:type="d8p1:SpreadsheetDocumentCellLineType">Solid</d8p1:style>
							</value>
						</item>
						<item xsi:type="dcsset:SettingsParameterValue">
							<parameter>СтильГраницы.Справа</parameter>
							<value xmlns:d8p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d8p1:Line" width="2" gap="false">
								<d8p1:style xsi:type="d8p1:SpreadsheetDocumentCellLineType">Solid</d8p1:style>
							</value>
						</item>
					</item>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>ГоризонтальноеПоложение</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d7p1:HorizontalAlign">Center</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Отклонение</dataPath>
				<field>Отклонение</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Отклонение</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<use>false</use>
						<parameter>СтильГраницы</parameter>
						<value xmlns:d7p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d7p1:Line" width="0" gap="false">
							<d7p1:style xsi:type="d7p1:SpreadsheetDocumentCellLineType">None</d7p1:style>
						</value>
						<item xsi:type="dcsset:SettingsParameterValue">
							<parameter>СтильГраницы.Справа</parameter>
							<value xmlns:d8p1="http://v8.1c.ru/8.1/data/ui" xsi:type="d8p1:Line" width="2" gap="false">
								<d8p1:style xsi:type="d8p1:SpreadsheetDocumentCellLineType">Solid</d8p1:style>
							</value>
						</item>
					</item>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧЦ=7; ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Сумма</dataPath>
				<field>Сумма</field>
				<title xmlns:d5p1="http://v8.1c.ru/8.1/data/core" xsi:type="d5p1:LocalStringType">
					<d5p1:item>
						<d5p1:lang>ru</d5p1:lang>
						<d5p1:content>Сумма, руб</d5p1:content>
					</d5p1:item>
				</title>
				<appearance>
					<item xmlns="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:dcsset="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="dcsset:SettingsParameterValue">
						<parameter>Формат</parameter>
						<value xsi:type="xs:string">ЧЦ=9; ЧДЦ=2</value>
					</item>
				</appearance>
			</field>
			<field xsi:type="DataSetFieldField">
				<dataPath>Вес</dataPath>
				<field>Вес</field>
			</field>
			<dataSource>ИсточникДанных1</dataSource>
			<query>ВЫБРАТЬ
	Отклонение.Дистрибьютор КАК Дистрибьютор,
	МЕСЯЦ(Отклонение.ДатаПродажи) КАК Период,
	СРЕДНЕЕ((Отклонение.ЦенаПродажи / Отклонение.ЦенаПокупки - 1) * 100) КАК Отклонение
ПОМЕСТИТЬ ОтклонениеПоНоменклатуре
ИЗ
	(ВЫБРАТЬ
		ДатыПродаж.Дистрибьютор КАК Дистрибьютор,
		ДатыПродаж.Номенклатура КАК Номенклатура,
		ДатыПродаж.ДатаПродажи КАК ДатаПродажи,
		МАКСИМУМ(ЦеныНоменклатуры.Период) КАК ДатаПокупки,
		МАКСИМУМ(ЦеныНоменклатуры.Цена) КАК ЦенаПокупки,
		МАКСИМУМ(ДатыПродаж.Цена) КАК ЦенаПродажи
	ИЗ
		РегистрСведений.ЦеныНоменклатуры КАК ЦеныНоменклатуры
			ВНУТРЕННЕЕ СОЕДИНЕНИЕ (ВЫБРАТЬ РАЗЛИЧНЫЕ
				Продажи.Период КАК ДатаПродажи,
				Продажи.Дистрибьютор КАК Дистрибьютор,
				Продажи.Номенклатура КАК Номенклатура,
				СРЕДНЕЕ(ВЫБОР
						КОГДА Продажи.Количество = 0
							ТОГДА 0
						ИНАЧЕ Продажи.Сумма / Продажи.Количество
					КОНЕЦ) КАК Цена
			ИЗ
				РегистрНакопления.Продажи КАК Продажи
			ГДЕ
				Продажи.Период &lt;= &amp;КонецПериода
				И Продажи.Период &gt;= &amp;НачалоПериода
				И Продажи.Сумма &gt; 0
			
			СГРУППИРОВАТЬ ПО
				Продажи.Период,
				Продажи.Дистрибьютор,
				Продажи.Номенклатура) КАК ДатыПродаж
			ПО ЦеныНоменклатуры.Период &lt;= ДатыПродаж.ДатаПродажи
				И ЦеныНоменклатуры.Дистрибьютор = ДатыПродаж.Дистрибьютор
				И ЦеныНоменклатуры.Номенклатура = ДатыПродаж.Номенклатура
	ГДЕ
		ДатыПродаж.ДатаПродажи &gt;= ЦеныНоменклатуры.Период
	
	СГРУППИРОВАТЬ ПО
		ДатыПродаж.ДатаПродажи,
		ДатыПродаж.Дистрибьютор,
		ДатыПродаж.Номенклатура) КАК Отклонение

СГРУППИРОВАТЬ ПО
	Отклонение.Дистрибьютор,
	МЕСЯЦ(Отклонение.ДатаПродажи)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	МЕСЯЦ(Продажи.Период) КАК Период,
	Продажи.Дистрибьютор КАК Дистрибьютор,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Продажи.Контрагент) КАК Контрагент,
	0 КАК Номенклатура,
	СУММА(Продажи.Сумма) КАК Сумма,
	СУММА(Продажи.Вес) КАК Вес
ПОМЕСТИТЬ ВременнаяТаблица
ИЗ
	РегистрНакопления.Продажи КАК Продажи
ГДЕ
	Продажи.Период &gt;= &amp;НачалоПериода
	И Продажи.Период &lt;= &amp;КонецПериода

СГРУППИРОВАТЬ ПО
	Продажи.Дистрибьютор,
	МЕСЯЦ(Продажи.Период)

ОБЪЕДИНИТЬ ВСЕ

ВЫБРАТЬ
	МЕСЯЦ(Продажи.Период),
	Продажи.Дистрибьютор,
	0,
	КОЛИЧЕСТВО(РАЗЛИЧНЫЕ Продажи.Номенклатура),
	0,
	0
ИЗ
	РегистрНакопления.Продажи КАК Продажи
ГДЕ
	Продажи.Период &gt;= &amp;НачалоПериода
	И Продажи.Период &lt;= &amp;КонецПериода

СГРУППИРОВАТЬ ПО
	Продажи.Дистрибьютор,
	МЕСЯЦ(Продажи.Период)
;

////////////////////////////////////////////////////////////////////////////////
ВЫБРАТЬ
	ВременнаяТаблица.Период КАК Период,
	ВременнаяТаблица.Дистрибьютор КАК Дистрибьютор,
	СУММА(ВременнаяТаблица.Контрагент) КАК Контрагент,
	СУММА(ВременнаяТаблица.Номенклатура) КАК Номенклатура,
	СРЕДНЕЕ(ОтклонениеПоНоменклатуре.Отклонение) КАК Отклонение,
	СУММА(ВременнаяТаблица.Сумма) КАК Сумма,
	СУММА(ВременнаяТаблица.Вес) КАК Вес
ИЗ
	ВременнаяТаблица КАК ВременнаяТаблица
		ЛЕВОЕ СОЕДИНЕНИЕ ОтклонениеПоНоменклатуре КАК ОтклонениеПоНоменклатуре
		ПО ВременнаяТаблица.Дистрибьютор = ОтклонениеПоНоменклатуре.Дистрибьютор
			И ВременнаяТаблица.Период = ОтклонениеПоНоменклатуре.Период

СГРУППИРОВАТЬ ПО
	ВременнаяТаблица.Дистрибьютор,
	ВременнаяТаблица.Период

УПОРЯДОЧИТЬ ПО
	Дистрибьютор,
	Период,
	Контрагент,
	Номенклатура</query>
		</dataSet>
		<calculatedField>
			<dataPath>ВесВКГ</dataPath>
			<expression>Вес*1000</expression>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Вес, кг</d4p1:content>
				</d4p1:item>
			</title>
		</calculatedField>
		<totalField>
			<dataPath>Контрагент</dataPath>
			<expression>Среднее(Контрагент)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<totalField>
			<dataPath>Номенклатура</dataPath>
			<expression>Среднее(Номенклатура)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<totalField>
			<dataPath>Отклонение</dataPath>
			<expression>Сумма(Отклонение)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<totalField>
			<dataPath>Сумма</dataPath>
			<expression>Сумма(Сумма)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<totalField>
			<dataPath>Вес</dataPath>
			<expression>Сумма(Вес)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<totalField>
			<dataPath>ВесВКГ</dataPath>
			<expression>Сумма(ВесВКГ)</expression>
			<group>Дистрибьютор</group>
		</totalField>
		<parameter>
			<name>НачалоПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Начало периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;Период.ДатаНачала</expression>
			<denyIncompleteValues>true</denyIncompleteValues>
		</parameter>
		<parameter>
			<name>КонецПериода</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Конец периода</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">xs:dateTime</Type>
				<DateQualifiers xmlns="http://v8.1c.ru/8.1/data/core">
					<DateFractions>DateTime</DateFractions>
				</DateQualifiers>
			</valueType>
			<value xsi:type="xs:dateTime">0001-01-01T00:00:00</value>
			<useRestriction>true</useRestriction>
			<expression>&amp;Период.ДатаОкончания</expression>
			<denyIncompleteValues>true</denyIncompleteValues>
		</parameter>
		<parameter>
			<name>Период</name>
			<title xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:LocalStringType">
				<d4p1:item>
					<d4p1:lang>ru</d4p1:lang>
					<d4p1:content>Период</d4p1:content>
				</d4p1:item>
			</title>
			<valueType>
				<Type xmlns="http://v8.1c.ru/8.1/data/core">StandardPeriod</Type>
			</valueType>
			<value xmlns:d4p1="http://v8.1c.ru/8.1/data/core" xsi:type="d4p1:StandardPeriod">
				<d4p1:variant xsi:type="d4p1:StandardPeriodVariant">Custom</d4p1:variant>
				<d4p1:startDate>0001-01-01T00:00:00</d4p1:startDate>
				<d4p1:endDate>0001-01-01T00:00:00</d4p1:endDate>
			</value>
			<useRestriction>false</useRestriction>
			<denyIncompleteValues>true</denyIncompleteValues>
		</parameter>
		<settingsVariant>
			<name xmlns="http://v8.1c.ru/8.1/data-composition-system/settings">Основной</name>
			<presentation xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xsi:type="xs:string">Основной</presentation>
		</settingsVariant>
	</dataCompositionSchema>
</SchemaFile>﻿<?xml version="1.0" encoding="UTF-8"?>
<Settings xmlns="http://v8.1c.ru/8.1/data-composition-system/settings" xmlns:dcscor="http://v8.1c.ru/8.1/data-composition-system/core" xmlns:style="http://v8.1c.ru/8.1/data/ui/style" xmlns:sys="http://v8.1c.ru/8.1/data/ui/fonts/system" xmlns:v8="http://v8.1c.ru/8.1/data/core" xmlns:v8ui="http://v8.1c.ru/8.1/data/ui" xmlns:web="http://v8.1c.ru/8.1/data/ui/colors/web" xmlns:win="http://v8.1c.ru/8.1/data/ui/colors/windows" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<selection>
		<item xsi:type="SelectedItemField">
			<field>Дистрибьютор</field>
		</item>
	</selection>
	<filter>
		<item xsi:type="FilterItemComparison">
			<use>false</use>
			<left xsi:type="dcscor:Field">Дистрибьютор</left>
			<comparisonType>Equal</comparisonType>
			<userSettingID>51df5288-9a5f-4ac6-b579-aefbbcdb2215</userSettingID>
		</item>
	</filter>
	<dataParameters>
		<dcscor:item xsi:type="SettingsParameterValue">
			<dcscor:parameter>Период</dcscor:parameter>
			<dcscor:value xsi:type="v8:StandardPeriod">
				<v8:variant xsi:type="v8:StandardPeriodVariant">Custom</v8:variant>
				<v8:startDate>0001-01-01T00:00:00</v8:startDate>
				<v8:endDate>0001-01-01T00:00:00</v8:endDate>
			</dcscor:value>
			<userSettingID>21ccfc97-af6b-4c0d-99a2-929060efd69a</userSettingID>
		</dcscor:item>
	</dataParameters>
	<order>
		<item xsi:type="OrderItemField">
			<field>Дистрибьютор</field>
			<orderType>Asc</orderType>
		</item>
	</order>
	<item xsi:type="StructureItemTable">
		<column>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Период</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
			</selection>
		</column>
		<row>
			<groupItems>
				<item xsi:type="GroupItemField">
					<field>Дистрибьютор</field>
					<groupType>Items</groupType>
					<periodAdditionType>None</periodAdditionType>
					<periodAdditionBegin xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionBegin>
					<periodAdditionEnd xsi:type="xs:dateTime">0001-01-01T00:00:00</periodAdditionEnd>
				</item>
			</groupItems>
			<order>
				<item xsi:type="OrderItemAuto"/>
			</order>
			<selection>
				<item xsi:type="SelectedItemAuto"/>
				<item xsi:type="SelectedItemField">
					<field>Контрагент</field>
				</item>
				<item xsi:type="SelectedItemField">
					<field>Номенклатура</field>
				</item>
				<item xsi:type="SelectedItemField">
					<field>ВесВКГ</field>
				</item>
				<item xsi:type="SelectedItemField">
					<field>Сумма</field>
				</item>
				<item xsi:type="SelectedItemField">
					<field>Отклонение</field>
				</item>
			</selection>
		</row>
		<selection>
			<item xsi:type="SelectedItemAuto"/>
		</selection>
	</item>
</Settings>﻿<?xml version="1.0" encoding="UTF-8"?>
<SchemaFile xmlns="" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<dataCompositionSchema xmlns="http://v8.1c.ru/8.1/data-composition-system/schema"/>
</SchemaFile>